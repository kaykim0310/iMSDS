# MSDS 프로그램 - KOSHA API 연동 가이드

## 📋 개요

이 업데이트는 MSDS 작성 프로그램에 **KOSHA(안전보건공단) API**를 연동하여 
CAS 번호 기반으로 화학물질 정보를 자동 조회하는 기능을 추가합니다.

### 연동되는 MSDS 항목
| 섹션 | 항목명 | 조회 내용 |
|------|--------|----------|
| 11 | 독성에 관한 정보 | 급성독성, 자극성, 발암성 등 |
| 12 | 환경에 미치는 영향 | 수생독성, 잔류성, 생물농축성 등 |
| 15 | 법적 규제현황 | 산업안전보건법, 화학물질관리법 등 |

---

## 📁 파일 구성

```
msds_api_integration/
├── kosha_api_extended.py          # KOSHA API 확장 모듈
└── pages/
    ├── 11_11_독성에_관한_정보.py   # 섹션 11 (API 연동)
    ├── 12_12_환경에_미치는_영향.py # 섹션 12 (API 연동)
    └── 15_15_법적_규제현황.py      # 섹션 15 (API 연동)
```

---

## 🔧 설치 방법

### 1. 파일 복사

기존 MSDS 프로젝트에 파일을 복사합니다:

```bash
# API 모듈 복사 (프로젝트 루트에)
cp kosha_api_extended.py /your_project/

# 페이지 파일 복사 (기존 pages 폴더에 덮어쓰기)
cp pages/*.py /your_project/pages/
```

### 2. 의존성 설치

`requirements.txt`에 다음 패키지가 필요합니다 (이미 있다면 생략):

```
requests>=2.28.0
```

### 3. API 모듈 경로 수정

각 페이지 파일 상단의 경로를 프로젝트에 맞게 수정합니다:

```python
# 변경 전
sys.path.insert(0, '/home/claude')

# 변경 후 (예시)
sys.path.insert(0, '/path/to/your/project')
# 또는
sys.path.insert(0, os.path.dirname(os.path.dirname(__file__)))
```

---

## 🚀 사용 방법

### 1. 구성성분 등록 (섹션 3)

먼저 **섹션 3 (구성성분의 명칭 및 함유량)**에서 
물질명과 CAS 번호를 등록합니다.

### 2. API 조회

섹션 11, 12, 15 페이지에서:

1. 상단의 **"🔗 KOSHA API 연동"** 영역을 확인
2. 등록된 CAS 번호 목록이 표시됨
3. **"🔍 KOSHA API에서 ○○ 정보 조회"** 버튼 클릭
4. 조회 결과 확인 후 **"📝 조회 결과를 아래 양식에 자동 채우기"** 클릭

### 3. 결과 확인 및 수정

- API 조회 결과는 참고용입니다
- 필요시 수동으로 내용을 수정하세요
- 최신 법규 개정 사항은 별도로 확인하세요

---

## 🔌 KOSHA API 정보

### 엔드포인트

| 엔드포인트 | MSDS 항목 |
|----------|----------|
| `/chemlist` | CAS 번호로 물질 검색 |
| `/chemdetail11` | 독성에 관한 정보 |
| `/chemdetail12` | 환경에 미치는 영향 |
| `/chemdetail15` | 법적 규제현황 |

### API 키

현재 기본 API 키가 포함되어 있습니다. 
운영 환경에서는 KOSHA에서 별도 발급받은 키를 사용하세요:

```python
# kosha_api_extended.py에서 수정
API_KEY = "your_api_key_here"
```

### 호출 제한

- 연속 호출 시 **0.3초 이상** 간격 권장
- 초당 **10회** 이하 호출 권장

---

## ⚠️ 주의사항

1. **API 데이터는 참고용**
   - 최신 법규 개정 사항을 추가로 확인하세요
   - KOSHA 데이터가 100% 완전하지 않을 수 있습니다

2. **네트워크 연결 필요**
   - API 조회를 위해 인터넷 연결이 필요합니다
   - 조회 실패 시 수동 입력을 사용하세요

3. **미등록 물질**
   - KOSHA에 등록되지 않은 물질은 "물질 미등록"으로 표시됩니다
   - 이 경우 수동으로 정보를 입력하세요

---

## 📞 지원

- KOSHA 화학물질정보시스템: https://msds.kosha.or.kr
- 화학물질정보시스템(ICIS): https://icis.me.go.kr

---

*작성일: 2026-01-15*
